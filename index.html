<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTG - Guess The Gold</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .main-content {
            display: flex;
            width: 100%;
            gap: 20px;
        }
        
        .game-section {
            flex: 3;
        }
        
        .stats-section {
            flex: 1;
            min-width: 250px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            width: 100%;
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            color: #FFD700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            letter-spacing: 3px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #ccc;
            margin-bottom: 20px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        #level {
            color: #4dabf7;
        }
        
        #score {
            color: #51cf66;
        }
        
        #gold {
            color: #FFD700;
        }
        
        #lives {
            color: #ff6b6b;
        }
        
        #streak {
            color: #ff6b6b;
            animation: streakPulse 1s infinite;
        }
        
        @keyframes streakPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        #high-score {
            color: #FFD700;
        }
        
        .lives-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 5px;
        }
        
        .life {
            color: #ff6b6b;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .life.lost {
            color: #555;
            transform: scale(0.8);
        }
        
        .game-area {
            width: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        
        .game-instruction {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: #ddd;
            min-height: 40px;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .options-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .options-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .option {
            background: linear-gradient(145deg, #2d3746, #1e2633);
            border-radius: 10px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            color: #FFD700;
            position: relative;
            overflow: hidden;
        }
        
        .option:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            background: linear-gradient(145deg, #3a4759, #2a3444);
        }
        
        .option.revealed {
            cursor: default;
        }
        
        .option.revealed:hover {
            transform: none;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .gold {
            background: linear-gradient(145deg, #ffd700, #daa520) !important;
            color: #8b6914 !important;
            animation: goldGlow 1.5s infinite alternate;
        }
        
        @keyframes goldGlow {
            from { box-shadow: 0 0 15px rgba(255, 215, 0, 0.7); }
            to { box-shadow: 0 0 25px rgba(255, 215, 0, 0.9); }
        }
        
        .empty {
            background: linear-gradient(145deg, #4a5568, #2d3748) !important;
            color: #777 !important;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-start {
            background: linear-gradient(to right, #FFD700, #FFA500);
            color: #000;
        }
        
        .btn-next {
            background: linear-gradient(to right, #4dabf7, #339af0);
            color: white;
            display: none;
        }
        
        .btn-hint {
            background: linear-gradient(to right, #51cf66, #40c057);
            color: white;
            display: none;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn:disabled {
            background: #555;
            color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .game-over {
            display: none;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 40px;
            border-radius: 15px;
            margin-top: 30px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        
        .game-over h2 {
            color: #FFD700;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .game-over p {
            font-size: 1.2rem;
            margin-bottom: 25px;
        }
        
        .level-progress {
            width: 100%;
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin: 30px 0;
            overflow: hidden;
        }
        
        .level-progress-bar {
            height: 100%;
            background: linear-gradient(to right, #FFD700, #FFA500);
            width: 1%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        footer {
            margin-top: 30px;
            text-align: center;
            color: #777;
            font-size: 0.9rem;
        }
        
        .icon-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .icon-list i {
            font-size: 1.5rem;
            color: #FFD700;
        }
        
        .pulse {
            animation: pulseAnimation 1.5s infinite alternate;
        }
        
        @keyframes pulseAnimation {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        .shake {
            animation: shakeAnimation 0.5s;
        }
        
        @keyframes shakeAnimation {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .hint-highlight {
            animation: hintGlow 1s infinite alternate;
            border: 3px solid #51cf66;
        }
        
        @keyframes hintGlow {
            from { box-shadow: 0 0 10px rgba(81, 207, 102, 0.5); }
            to { box-shadow: 0 0 20px rgba(81, 207, 102, 0.8); }
        }
        
        .difficulty-info {
            font-size: 1rem;
            color: #aaa;
            margin-top: 10px;
            font-style: italic;
        }
        
        .hint-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .hint-content {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        
        .hint-content h3 {
            color: #FFD700;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .hint-content p {
            margin-bottom: 25px;
            font-size: 1.2rem;
        }
        
        .hint-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .hint-option {
            position: relative;
        }
        
        .hint-option.hinted::after {
            content: "?";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: rgba(255, 255, 255, 0.2);
            font-weight: bold;
        }
        
        .boss-level {
            color: #ff6b6b !important;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        
        /* POWER-UPS STYLES */
        .power-ups-container {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .power-ups-title {
            font-size: 1.3rem;
            color: #FFD700;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .power-ups {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .power-up {
            background: linear-gradient(145deg, #495057, #343a40);
            border: none;
            border-radius: 10px;
            padding: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 0.9rem;
        }
        
        .power-up:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        
        .power-up:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .power-up i {
            font-size: 1.5rem;
        }
        
        .power-up-cost {
            color: #FFD700;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .power-up.double-gold {
            background: linear-gradient(145deg, #ffd700, #daa520);
            color: #000;
        }
        
        .power-up.extra-life {
            background: linear-gradient(145deg, #ff6b6b, #fa5252);
        }
        
        .power-up.eliminate {
            background: linear-gradient(145deg, #4dabf7, #339af0);
        }
        
        .power-up.active {
            animation: activePowerUp 1s infinite alternate;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }
        
        @keyframes activePowerUp {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        /* STATISTICS PANEL STYLES */
        .statistics-panel {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .statistics-title {
            font-size: 1.5rem;
            color: #FFD700;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-label {
            color: #aaa;
            font-size: 0.9rem;
        }
        
        .stat-value {
            color: #fff;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .stat-highlight {
            color: #FFD700;
            animation: statPulse 2s infinite;
        }
        
        @keyframes statPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* STREAK NOTIFICATION */
        .streak-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #ff6b6b, #fa5252);
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 2000;
            display: none;
            animation: streakNotification 1s;
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.7);
        }
        
        @keyframes streakNotification {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        /* SOUND CONTROLS */
        .sound-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .sound-btn {
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .sound-btn:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }
        
        .sound-btn.muted {
            color: #ff6b6b;
        }
        
        /* ELIMINATED OPTION STYLE */
        .eliminated {
            opacity: 0.3;
            cursor: not-allowed !important;
            transform: scale(0.9) !important;
        }
        
        .eliminated:hover {
            transform: scale(0.9) !important;
        }
    </style>
</head>
<body>
    <div class="sound-controls">
        <button class="sound-btn" id="sound-toggle">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-question-circle"></i> GTG</h1>
            <p class="subtitle">Guess The Gold - Find the hidden gold behind the question marks!</p>
        </header>
        
        <div class="game-info">
            <div class="info-item">
                <div class="info-label">LEVEL</div>
                <div class="info-value" id="level-display">0/99</div>
            </div>
            <div class="info-item">
                <div class="info-label">SCORE</div>
                <div class="info-value" id="score-display">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">GOLD</div>
                <div class="info-value" id="gold-display">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">STREAK</div>
                <div class="info-value" id="streak-display">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">LIVES</div>
                <div class="info-value" id="lives-display">3</div>
                <div class="lives-container" id="lives-icons">
                    <i class="fas fa-heart life"></i>
                    <i class="fas fa-heart life"></i>
                    <i class="fas fa-heart life"></i>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">HIGH SCORE</div>
                <div class="info-value" id="high-score-display">0</div>
            </div>
        </div>
        
        <div class="level-progress">
            <div class="level-progress-bar" id="level-progress-bar"></div>
        </div>
        
        <div class="main-content">
            <div class="game-section">
                <div class="game-area">
                    <div class="game-instruction" id="instruction">
                        Click "Start Game" to begin your intense treasure hunt!
                    </div>
                    
                    <div class="difficulty-info" id="difficulty-info">
                        Difficulty: Easy (2 options)
                    </div>
                    
                    <div class="options-container" id="options-container">
                        <!-- Options will be generated by JavaScript -->
                    </div>
                    
                    <div class="power-ups-container">
                        <div class="power-ups-title">Power-Ups</div>
                        <div class="power-ups">
                            <button class="power-up double-gold" id="power-double-gold" data-type="double-gold" data-cost="5">
                                <i class="fas fa-coins"></i>
                                <span>2x Gold</span>
                                <span class="power-up-cost">Cost: 5 Gold</span>
                            </button>
                            <button class="power-up extra-life" id="power-extra-life" data-type="extra-life" data-cost="10">
                                <i class="fas fa-heart"></i>
                                <span>+1 Life</span>
                                <span class="power-up-cost">Cost: 10 Gold</span>
                            </button>
                            <button class="power-up eliminate" id="power-eliminate" data-type="eliminate" data-cost="8">
                                <i class="fas fa-times"></i>
                                <span>Remove 2 Options</span>
                                <span class="power-up-cost">Cost: 8 Gold</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-start" id="start-btn">
                            <i class="fas fa-play"></i> Start Game
                        </button>
                        <button class="btn btn-next" id="next-btn">
                            <i class="fas fa-forward"></i> Next Level
                        </button>
                        <button class="btn btn-hint" id="hint-btn">
                            <i class="fas fa-lightbulb"></i> Get Hint (Cost: 2 Gold)
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="stats-section">
                <div class="statistics-panel">
                    <h3 class="statistics-title">Your Statistics</h3>
                    <div class="stat-item">
                        <span class="stat-label">Total Games Played:</span>
                        <span class="stat-value" id="total-games">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Success Rate:</span>
                        <span class="stat-value" id="success-rate">0%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Average Score:</span>
                        <span class="stat-value" id="avg-score">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Highest Streak:</span>
                        <span class="stat-value stat-highlight" id="highest-streak">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Gold Collected:</span>
                        <span class="stat-value" id="total-gold">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Power-ups Used:</span>
                        <span class="stat-value" id="powerups-used">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Hints Used:</span>
                        <span class="stat-value" id="hints-used">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Accuracy:</span>
                        <span class="stat-value" id="accuracy">0%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hint-modal" id="hint-modal">
            <div class="hint-content">
                <h3><i class="fas fa-lightbulb"></i> Use Hint?</h3>
                <p>Using a hint will reveal the gold's location but will cost you <span style="color:#FFD700;">2 Gold</span>.</p>
                <p>You currently have: <span id="current-gold-hint" style="color:#FFD700; font-weight:bold;">0</span> Gold</p>
                <div class="hint-buttons">
                    <button class="btn btn-start" id="confirm-hint-btn">
                        <i class="fas fa-check"></i> Yes, Use Hint
                    </button>
                    <button class="btn" id="cancel-hint-btn" style="background:linear-gradient(to right, #868e96, #495057);">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
        
        <div class="game-over" id="game-over">
            <h2>Game Over!</h2>
            <p>You've run out of lives. Try again to beat your high score!</p>
            <p>Level Reached: <span id="final-level">0</span>/99</p>
            <p>Gold Collected: <span id="final-gold">0</span></p>
            <p>Final Score: <span id="final-score">0</span></p>
            <p>High Score: <span id="final-high-score">0</span></p>
            <button class="btn btn-start" id="restart-btn">
                <i class="fas fa-redo"></i> Play Again
            </button>
        </div>
        
        <div class="streak-notification" id="streak-notification">
            <!-- Streak notifications will appear here -->
        </div>
        
        <footer>
            <p>GTG - Guess The Gold &copy; 2023 | Now with power-ups and statistics!</p>
            <p>Build streaks for bonus points and use power-ups strategically!</p>
        </footer>
    </div>

    <script>
        // Game state with Phase 1 enhancements
        const gameState = {
            level: 0,
            score: 0,
            gold: 0,
            lives: 3,
            maxLives: 3,
            streak: 0,
            highScore: localStorage.getItem('gtgHighScore') || 0,
            maxLevels: 99,
            gameActive: false,
            goldPosition: -1,
            optionsCount: 2,
            revealedOptions: [],
            usingHint: false,
            
            // Statistics
            totalGames: parseInt(localStorage.getItem('gtgTotalGames')) || 0,
            totalWins: parseInt(localStorage.getItem('gtgTotalWins')) || 0,
            totalGold: parseInt(localStorage.getItem('gtgTotalGold')) || 0,
            totalGuesses: parseInt(localStorage.getItem('gtgTotalGuesses')) || 0,
            correctGuesses: parseInt(localStorage.getItem('gtgCorrectGuesses')) || 0,
            highestStreak: parseInt(localStorage.getItem('gtgHighestStreak')) || 0,
            powerupsUsed: parseInt(localStorage.getItem('gtgPowerupsUsed')) || 0,
            hintsUsed: parseInt(localStorage.getItem('gtgHintsUsed')) || 0,
            
            // Active power-ups
            activePowerUps: {
                doubleGold: false,
                extraLife: false,
                eliminate: false
            },
            
            // Audio system
            soundEnabled: localStorage.getItem('gtgSoundEnabled') !== 'false',
            
            // Streak bonus system
            streakBonus: {
                minStreak: 3,
                multiplier: 1.5,
                maxStreak: 10
            }
        };
        
        // Level difficulty mapping
        function getOptionsCountForLevel(level) {
            if (level >= 1 && level <= 10) return 2;
            if (level >= 11 && level <= 20) return 3;
            if (level >= 21 && level <= 30) return 3;
            if (level >= 31 && level <= 35) return 4;
            if (level >= 36 && level <= 50) return 5;
            if (level >= 51 && level <= 75) return 6;
            if (level >= 76 && level <= 90) return 7;
            if (level >= 91 && level <= 99) return 10;
            return 2;
        }
        
        // Difficulty names
        const difficultyNames = {
            2: 'Easy',
            3: 'Medium',
            4: 'Hard',
            5: 'Very Hard',
            6: 'Extreme',
            7: 'Insane',
            10: 'BOSS LEVEL'
        };
        
        // DOM elements
        const levelDisplay = document.getElementById('level-display');
        const scoreDisplay = document.getElementById('score-display');
        const goldDisplay = document.getElementById('gold-display');
        const streakDisplay = document.getElementById('streak-display');
        const livesDisplay = document.getElementById('lives-display');
        const highScoreDisplay = document.getElementById('high-score-display');
        const livesIcons = document.getElementById('lives-icons');
        const instruction = document.getElementById('instruction');
        const difficultyInfo = document.getElementById('difficulty-info');
        const optionsContainer = document.getElementById('options-container');
        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const hintBtn = document.getElementById('hint-btn');
        const hintModal = document.getElementById('hint-modal');
        const confirmHintBtn = document.getElementById('confirm-hint-btn');
        const cancelHintBtn = document.getElementById('cancel-hint-btn');
        const currentGoldHint = document.getElementById('current-gold-hint');
        const gameOverScreen = document.getElementById('game-over');
        const finalScore = document.getElementById('final-score');
        const finalHighScore = document.getElementById('final-high-score');
        const finalLevel = document.getElementById('final-level');
        const finalGold = document.getElementById('final-gold');
        const restartBtn = document.getElementById('restart-btn');
        const levelProgressBar = document.getElementById('level-progress-bar');
        const soundToggle = document.getElementById('sound-toggle');
        const streakNotification = document.getElementById('streak-notification');
        
        // Power-up elements
        const powerDoubleGold = document.getElementById('power-double-gold');
        const powerExtraLife = document.getElementById('power-extra-life');
        const powerEliminate = document.getElementById('power-eliminate');
        
        // Statistics elements
        const totalGamesStat = document.getElementById('total-games');
        const successRateStat = document.getElementById('success-rate');
        const avgScoreStat = document.getElementById('avg-score');
        const highestStreakStat = document.getElementById('highest-streak');
        const totalGoldStat = document.getElementById('total-gold');
        const powerupsUsedStat = document.getElementById('powerups-used');
        const hintsUsedStat = document.getElementById('hints-used');
        const accuracyStat = document.getElementById('accuracy');
        
        // Sound effects (using Web Audio API for better performance)
        class SoundManager {
            constructor() {
                this.enabled = gameState.soundEnabled;
                this.audioContext = null;
                this.init();
            }
            
            init() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.log("Web Audio API not supported");
                    this.enabled = false;
                }
            }
            
            playSound(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.enabled || !this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }
            
            playCorrect() {
                this.playSound(523.25, 0.3, 'sine', 0.2); // C5
                this.playSound(659.25, 0.3, 'sine', 0.2); // E5
                this.playSound(783.99, 0.3, 'sine', 0.2); // G5
            }
            
            playWrong() {
                this.playSound(220, 0.5, 'sawtooth', 0.2); // A3
                this.playSound(196, 0.5, 'sawtooth', 0.2); // G3
            }
            
            playHint() {
                this.playSound(880, 0.2, 'sine', 0.2); // A5
                setTimeout(() => this.playSound(1046.5, 0.2, 'sine', 0.2), 100); // C6
            }
            
            playLevelUp() {
                this.playSound(523.25, 0.1, 'sine', 0.2); // C5
                setTimeout(() => this.playSound(659.25, 0.1, 'sine', 0.2), 100); // E5
                setTimeout(() => this.playSound(783.99, 0.1, 'sine', 0.2), 200); // G5
                setTimeout(() => this.playSound(1046.5, 0.3, 'sine', 0.2), 300); // C6
            }
            
            playGameOver() {
                this.playSound(220, 0.5, 'sawtooth', 0.3); // A3
                setTimeout(() => this.playSound(196, 0.5, 'sawtooth', 0.3), 200); // G3
                setTimeout(() => this.playSound(174.61, 0.8, 'sawtooth', 0.3), 400); // F3
            }
            
            playStreak(streak) {
                for (let i = 0; i < Math.min(streak, 5); i++) {
                    setTimeout(() => {
                        this.playSound(440 * (1 + i * 0.2), 0.1, 'sine', 0.2);
                    }, i * 100);
                }
            }
            
            playPowerUp() {
                this.playSound(659.25, 0.2, 'square', 0.2); // E5
                this.playSound(830.61, 0.2, 'square', 0.2); // G#5
                this.playSound(987.77, 0.2, 'square', 0.2); // B5
            }
            
            toggle() {
                this.enabled = !this.enabled;
                gameState.soundEnabled = this.enabled;
                localStorage.setItem('gtgSoundEnabled', this.enabled);
                updateSoundButton();
                
                if (this.enabled && this.audioContext && this.audioContext.state === 'suspended') {
                    this.audioContext.resume();
                }
            }
        }
        
        const soundManager = new SoundManager();
        
        function updateSoundButton() {
            if (soundManager.enabled) {
                soundToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                soundToggle.classList.remove('muted');
            } else {
                soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                soundToggle.classList.add('muted');
            }
        }
        
        // Initialize the game
        function initGame() {
            gameState.level = 0;
            gameState.score = 0;
            gameState.gold = 0;
            gameState.lives = gameState.maxLives;
            gameState.streak = 0;
            gameState.gameActive = false;
            gameState.highScore = localStorage.getItem('gtgHighScore') || 0;
            gameState.usingHint = false;
            gameState.activePowerUps = {
                doubleGold: false,
                extraLife: false,
                eliminate: false
            };
            
            updateDisplays();
            updateLivesDisplay();
            updateStatistics();
            instruction.textContent = "Click 'Start Game' to begin your intense treasure hunt!";
            instruction.style.color = '#ddd';
            difficultyInfo.textContent = "Difficulty: Easy (2 options)";
            optionsContainer.innerHTML = '';
            nextBtn.style.display = 'none';
            hintBtn.style.display = 'none';
            hintModal.style.display = 'none';
            gameOverScreen.style.display = 'none';
            levelProgressBar.style.width = '0%';
            streakNotification.style.display = 'none';
            
            updatePowerUpButtons();
            updateSoundButton();
            
            // Generate initial empty options
            generateOptions();
        }
        
        // Update power-up button states
        function updatePowerUpButtons() {
            // Double Gold power-up
            if (gameState.gold >= 5 && !gameState.activePowerUps.doubleGold && gameState.gameActive) {
                powerDoubleGold.disabled = false;
            } else {
                powerDoubleGold.disabled = true;
            }
            
            // Extra Life power-up
            if (gameState.gold >= 10 && gameState.lives < gameState.maxLives && gameState.gameActive) {
                powerExtraLife.disabled = false;
            } else {
                powerExtraLife.disabled = true;
            }
            
            // Eliminate power-up
            if (gameState.gold >= 8 && gameState.gameActive && !gameState.activePowerUps.eliminate) {
                powerEliminate.disabled = false;
            } else {
                powerEliminate.disabled = true;
            }
        }
        
        // Start a new game
        function startGame() {
            gameState.gameActive = true;
            startBtn.disabled = true;
            gameState.totalGames++;
            localStorage.setItem('gtgTotalGames', gameState.totalGames);
            updateStatistics();
            nextLevel();
        }
        
        // Move to the next level
        function nextLevel() {
            if (gameState.level >= gameState.maxLevels) {
                completeGame();
                return;
            }
            
            gameState.level++;
            gameState.revealedOptions = [];
            gameState.usingHint = false;
            
            // Reset eliminate power-up for new level
            gameState.activePowerUps.eliminate = false;
            
            // Get options count based on level
            gameState.optionsCount = getOptionsCountForLevel(gameState.level);
            
            // Randomly select which option contains the gold
            gameState.goldPosition = Math.floor(Math.random() * gameState.optionsCount);
            
            updateDisplays();
            updatePowerUpButtons();
            
            // Update difficulty info with boss level styling
            const difficultyText = `Difficulty: ${difficultyNames[gameState.optionsCount]} (${gameState.optionsCount} options)`;
            difficultyInfo.textContent = difficultyText;
            
            if (gameState.level >= 91) {
                difficultyInfo.classList.add('boss-level');
                instruction.textContent = `BOSS LEVEL ${gameState.level}: Find the gold among ${gameState.optionsCount} options!`;
            } else {
                difficultyInfo.classList.remove('boss-level');
                instruction.textContent = `Level ${gameState.level}: Where is the gold? Click on a question mark to guess!`;
            }
            
            instruction.style.color = '#ddd';
            generateOptions();
            
            nextBtn.style.display = 'none';
            hintBtn.style.display = 'flex';
            levelProgressBar.style.width = `${(gameState.level / gameState.maxLevels) * 100}%`;
            
            // Play level up sound
            if (gameState.level > 1) {
                soundManager.playLevelUp();
            }
        }
        
        // Generate the option elements
        function generateOptions() {
            optionsContainer.innerHTML = '';
            
            // Clear any existing columns
            const existingColumns = document.querySelectorAll('.options-column');
            existingColumns.forEach(col => col.remove());
            
            // Set grid columns based on number of options
            let columns = Math.min(gameState.optionsCount, 5);
            if (gameState.optionsCount > 5 && gameState.optionsCount <= 7) columns = 4;
            if (gameState.optionsCount === 10) columns = 5;
            
            optionsContainer.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
            
            // Create option elements - ALL with question marks for intensity
            for (let i = 0; i < gameState.optionsCount; i++) {
                const option = document.createElement('div');
                option.className = 'option pulse hint-option';
                option.dataset.index = i;
                
                // Always use question mark icon for intensity
                option.innerHTML = `<i class="fas fa-question"></i>`;
                
                // Add click event listener
                option.addEventListener('click', () => selectOption(i));
                
                optionsContainer.appendChild(option);
            }
        }
        
        // Handle option selection
        function selectOption(index) {
            // If game is not active or option already revealed, do nothing
            if (!gameState.gameActive || gameState.revealedOptions.includes(index)) {
                return;
            }
            
            gameState.totalGuesses++;
            gameState.revealedOptions.push(index);
            
            const optionElement = document.querySelector(`.option[data-index="${index}"]`);
            optionElement.classList.remove('pulse');
            optionElement.classList.remove('hint-option');
            
            // Check if this is the gold position
            if (index === gameState.goldPosition) {
                // Correct guess
                gameState.correctGuesses++;
                optionElement.classList.add('gold');
                optionElement.innerHTML = '<i class="fas fa-gem"></i>';
                
                // Update streak
                gameState.streak++;
                if (gameState.streak > gameState.highestStreak) {
                    gameState.highestStreak = gameState.streak;
                    localStorage.setItem('gtgHighestStreak', gameState.highestStreak);
                }
                
                // Calculate base points
                const basePoints = 100 * gameState.level;
                
                // Apply streak bonus if applicable
                let streakBonusMultiplier = 1;
                if (gameState.streak >= gameState.streakBonus.minStreak) {
                    streakBonusMultiplier = gameState.streakBonus.multiplier;
                    if (gameState.streak > gameState.streakBonus.maxStreak) {
                        streakBonusMultiplier = gameState.streakBonus.multiplier * 1.5;
                    }
                    
                    // Show streak notification
                    if (gameState.streak >= 3 && gameState.streak <= 10) {
                        showStreakNotification(gameState.streak);
                    }
                }
                
                // Apply double gold power-up if active
                let goldMultiplier = 1;
                if (gameState.activePowerUps.doubleGold) {
                    goldMultiplier = 2;
                    gameState.activePowerUps.doubleGold = false;
                    updatePowerUpButtons();
                }
                
                const pointsEarned = Math.floor(basePoints * streakBonusMultiplier);
                gameState.score += pointsEarned;
                
                // Earn gold for correct guess (more for higher levels)
                const baseGoldEarned = 2 + Math.floor(gameState.level / 10);
                const goldEarned = baseGoldEarned * goldMultiplier;
                gameState.gold += goldEarned;
                gameState.totalGold += goldEarned;
                
                let bonusText = '';
                if (streakBonusMultiplier > 1) {
                    bonusText = ` (+${Math.round((streakBonusMultiplier - 1) * 100)}% streak bonus)`;
                }
                if (goldMultiplier > 1) {
                    bonusText += ` (2x gold power-up!)`;
                }
                
                instruction.textContent = `Correct! You found the gold! +${pointsEarned} points${bonusText}, +${goldEarned} gold`;
                instruction.style.color = '#FFD700';
                
                // Play correct sound
                soundManager.playCorrect();
                
                // Save statistics
                localStorage.setItem('gtgCorrectGuesses', gameState.correctGuesses);
                localStorage.setItem('gtgTotalGuesses', gameState.totalGuesses);
                localStorage.setItem('gtgTotalGold', gameState.totalGold);
                
                // Show next level button after a delay
                setTimeout(() => {
                    nextBtn.style.display = 'flex';
                }, 1000);
            } else {
                // Wrong guess - lose a life and reset streak
                gameState.streak = 0;
                gameState.lives--;
                updateLivesDisplay();
                
                optionElement.classList.add('empty');
                optionElement.innerHTML = '<i class="fas fa-times"></i>';
                optionElement.classList.add('shake');
                
                instruction.textContent = `Wrong! You lost a life. ${gameState.lives} remaining.`;
                instruction.style.color = '#ff6b6b';
                
                // Play wrong sound
                soundManager.playWrong();
                
                // Check if game over
                if (gameState.lives <= 0) {
                    setTimeout(() => {
                        gameOver();
                    }, 1500);
                    return;
                }
            }
            
            updateDisplays();
            updateStatistics();
            updatePowerUpButtons();
            
            // If all options have been revealed and gold not found, end the level
            if (gameState.revealedOptions.length === gameState.optionsCount && index !== gameState.goldPosition) {
                instruction.textContent = `No gold found! The gold was hidden elsewhere.`;
                
                // Reveal the gold location
                const goldElement = document.querySelector(`.option[data-index="${gameState.goldPosition}"]`);
                goldElement.classList.remove('pulse');
                goldElement.classList.remove('hint-option');
                goldElement.classList.add('gold');
                goldElement.innerHTML = '<i class="fas fa-gem"></i>';
                
                // Show next level button after a delay
                setTimeout(() => {
                    nextBtn.style.display = 'flex';
                }, 1500);
            }
        }
        
        // Show streak notification
        function showStreakNotification(streak) {
            const messages = {
                3: "ðŸ”¥ Hot Streak! 3x in a row!",
                4: "ðŸ”¥ðŸ”¥ On Fire! 4x streak!",
                5: "ðŸ”¥ðŸ”¥ðŸ”¥ Unstoppable! 5x streak!",
                6: "ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ Legendary! 6x streak!",
                7: "ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ Master! 7x streak!",
                8: "ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ Godlike! 8x streak!",
                9: "ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ Perfect! 9x streak!",
                10: "ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ ULTIMATE STREAK! 10x!"
            };
            
            streakNotification.textContent = messages[Math.min(streak, 10)] || `Streak: ${streak}!`;
            streakNotification.style.display = 'block';
            
            // Play streak sound
            soundManager.playStreak(streak);
            
            // Hide after 2 seconds
            setTimeout(() => {
                streakNotification.style.display = 'none';
            }, 2000);
        }
        
        // Power-up functions
        function activateDoubleGold() {
            if (gameState.gold >= 5 && !gameState.activePowerUps.doubleGold) {
                gameState.gold -= 5;
                gameState.activePowerUps.doubleGold = true;
                gameState.powerupsUsed++;
                localStorage.setItem('gtgPowerupsUsed', gameState.powerupsUsed);
                
                powerDoubleGold.classList.add('active');
                instruction.textContent = "2x Gold power-up activated! Your next correct guess will give double gold!";
                instruction.style.color = '#FFD700';
                
                // Play power-up sound
                soundManager.playPowerUp();
                
                updateDisplays();
                updateStatistics();
                updatePowerUpButtons();
            }
        }
        
        function activateExtraLife() {
            if (gameState.gold >= 10 && gameState.lives < gameState.maxLives) {
                gameState.gold -= 10;
                gameState.lives++;
                gameState.powerupsUsed++;
                localStorage.setItem('gtgPowerupsUsed', gameState.powerupsUsed);
                
                instruction.textContent = "+1 Life purchased! You now have " + gameState.lives + " lives.";
                instruction.style.color = '#ff6b6b';
                
                // Play power-up sound
                soundManager.playPowerUp();
                
                updateDisplays();
                updateLivesDisplay();
                updateStatistics();
                updatePowerUpButtons();
            }
        }
        
        function activateEliminate() {
            if (gameState.gold >= 8 && !gameState.activePowerUps.eliminate) {
                gameState.gold -= 8;
                gameState.activePowerUps.eliminate = true;
                gameState.powerupsUsed++;
                localStorage.setItem('gtgPowerupsUsed', gameState.powerupsUsed);
                
                // Find two wrong options to eliminate (not the gold)
                const wrongOptions = [];
                for (let i = 0; i < gameState.optionsCount; i++) {
                    if (i !== gameState.goldPosition && !gameState.revealedOptions.includes(i)) {
                        wrongOptions.push(i);
                    }
                }
                
                // Randomly select 2 wrong options to eliminate
                const optionsToEliminate = [];
                while (optionsToEliminate.length < 2 && wrongOptions.length > 0) {
                    const randomIndex = Math.floor(Math.random() * wrongOptions.length);
                    optionsToEliminate.push(wrongOptions.splice(randomIndex, 1)[0]);
                }
                
                // Mark eliminated options
                optionsToEliminate.forEach(optionIndex => {
                    const optionElement = document.querySelector(`.option[data-index="${optionIndex}"]`);
                    optionElement.classList.add('eliminated');
                    optionElement.innerHTML = '<i class="fas fa-ban"></i>';
                    optionElement.style.cursor = 'not-allowed';
                    optionElement.onclick = null;
                });
                
                powerEliminate.classList.add('active');
                instruction.textContent = "2 wrong options eliminated! Choose from the remaining options.";
                instruction.style.color = '#4dabf7';
                
                // Play power-up sound
                soundManager.playPowerUp();
                
                updateDisplays();
                updateStatistics();
                updatePowerUpButtons();
            }
        }
        
        // Use hint feature
        function useHint() {
            if (gameState.gold < 2) {
                instruction.textContent = "Not enough gold for a hint! You need at least 2 gold.";
                instruction.style.color = '#ff6b6b';
                return;
            }
            
            // Show hint confirmation modal
            currentGoldHint.textContent = gameState.gold;
            hintModal.style.display = 'flex';
        }
        
        // Confirm hint usage
        function confirmHint() {
            if (gameState.gold >= 2 && !gameState.usingHint) {
                gameState.gold -= 2;
                gameState.usingHint = true;
                gameState.hintsUsed++;
                localStorage.setItem('gtgHintsUsed', gameState.hintsUsed);
                
                updateDisplays();
                updateStatistics();
                
                // Remove hint button during hint usage
                hintBtn.style.display = 'none';
                
                // Highlight the correct option with hint
                const goldElement = document.querySelector(`.option[data-index="${gameState.goldPosition}"]`);
                goldElement.classList.add('hint-highlight');
                
                instruction.textContent = "Hint activated! The gold location is highlighted in green.";
                instruction.style.color = '#51cf66';
                
                // Play hint sound
                soundManager.playHint();
                
                // Remove hint after 3 seconds
                setTimeout(() => {
                    goldElement.classList.remove('hint-highlight');
                    hintBtn.style.display = 'flex';
                    gameState.usingHint = false;
                    instruction.textContent = "Hint expired! Try to find the gold now.";
                }, 3000);
            }
            
            hintModal.style.display = 'none';
        }
        
        // Update all display elements
        function updateDisplays() {
            levelDisplay.textContent = `${gameState.level}/${gameState.maxLevels}`;
            scoreDisplay.textContent = gameState.score;
            goldDisplay.textContent = gameState.gold;
            streakDisplay.textContent = gameState.streak;
            livesDisplay.textContent = gameState.lives;
            highScoreDisplay.textContent = gameState.highScore;
            
            // Update streak display animation
            if (gameState.streak >= 3) {
                streakDisplay.style.display = 'block';
            } else {
                streakDisplay.style.display = 'block';
            }
        }
        
        // Update statistics panel
        function updateStatistics() {
            totalGamesStat.textContent = gameState.totalGames;
            
            // Calculate success rate
            const successRate = gameState.totalGames > 0 ? 
                Math.round((gameState.totalWins / gameState.totalGames) * 100) : 0;
            successRateStat.textContent = `${successRate}%`;
            
            // Calculate average score
            const avgScore = gameState.totalGames > 0 ? 
                Math.round(gameState.score / gameState.totalGames) : 0;
            avgScoreStat.textContent = avgScore;
            
            // Update other stats
            highestStreakStat.textContent = gameState.highestStreak;
            totalGoldStat.textContent = gameState.totalGold;
            powerupsUsedStat.textContent = gameState.powerupsUsed;
            hintsUsedStat.textContent = gameState.hintsUsed;
            
            // Calculate accuracy
            const accuracy = gameState.totalGuesses > 0 ? 
                Math.round((gameState.correctGuesses / gameState.totalGuesses) * 100) : 0;
            accuracyStat.textContent = `${accuracy}%`;
        }
        
        // Update lives display with heart icons
        function updateLivesDisplay() {
            livesIcons.innerHTML = '';
            for (let i = 0; i < gameState.maxLives; i++) {
                const lifeIcon = document.createElement('i');
                lifeIcon.className = `fas fa-heart life ${i >= gameState.lives ? 'lost' : ''}`;
                livesIcons.appendChild(lifeIcon);
            }
        }
        
        // Game over when lives reach 0
        function gameOver() {
            gameState.gameActive = false;
            gameState.totalWins++;
            localStorage.setItem('gtgTotalWins', gameState.totalWins);
            
            // Update high score if current score is higher
            if (gameState.score > gameState.highScore) {
                gameState.highScore = gameState.score;
                localStorage.setItem('gtgHighScore', gameState.highScore);
            }
            
            finalScore.textContent = gameState.score;
            finalHighScore.textContent = gameState.highScore;
            finalLevel.textContent = gameState.level;
            finalGold.textContent = gameState.gold;
            
            gameOverScreen.style.display = 'block';
            hintBtn.style.display = 'none';
            instruction.textContent = "Game Over! You ran out of lives.";
            
            // Play game over sound
            soundManager.playGameOver();
            
            updateStatistics();
        }
        
        // Complete all levels
        function completeGame() {
            gameState.gameActive = false;
            gameState.totalWins++;
            localStorage.setItem('gtgTotalWins', gameState.totalWins);
            
            // Update high score if current score is higher
            if (gameState.score > gameState.highScore) {
                gameState.highScore = gameState.score;
                localStorage.setItem('gtgHighScore', gameState.highScore);
            }
            
            // Show completion screen
            instruction.textContent = "Congratulations! You've completed all 99 levels!";
            instruction.style.color = '#FFD700';
            hintBtn.style.display = 'none';
            
            // Create completion screen
            gameOverScreen.innerHTML = `
                <h2>Victory!</h2>
                <p>You've completed all 99 levels and found all the gold!</p>
                <p>Gold Collected: <span id="final-gold">${gameState.gold}</span></p>
                <p>Final Score: <span id="final-score">${gameState.score}</span></p>
                <p>High Score: <span id="final-high-score">${gameState.highScore}</span></p>
                <button class="btn btn-start" id="restart-btn">
                    <i class="fas fa-redo"></i> Play Again
                </button>
            `;
            
            gameOverScreen.style.display = 'block';
            levelProgressBar.style.width = '100%';
            
            // Reattach restart button event listener
            document.getElementById('restart-btn').addEventListener('click', initGame);
            
            updateStatistics();
        }
        
        // Event listeners
        startBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', nextLevel);
        hintBtn.addEventListener('click', useHint);
        confirmHintBtn.addEventListener('click', confirmHint);
        cancelHintBtn.addEventListener('click', () => {
            hintModal.style.display = 'none';
        });
        restartBtn.addEventListener('click', initGame);
        soundToggle.addEventListener('click', () => soundManager.toggle());
        
        // Power-up event listeners
        powerDoubleGold.addEventListener('click', activateDoubleGold);
        powerExtraLife.addEventListener('click', activateExtraLife);
        powerEliminate.addEventListener('click', activateEliminate);
        
        // Close hint modal when clicking outside
        hintModal.addEventListener('click', (e) => {
            if (e.target === hintModal) {
                hintModal.style.display = 'none';
            }
        });
        
        // Initialize the game on page load
        window.addEventListener('DOMContentLoaded', initGame);
        
        // Resume audio context on user interaction (required by browsers)
        document.addEventListener('click', () => {
            if (soundManager.audioContext && soundManager.audioContext.state === 'suspended') {
                soundManager.audioContext.resume();
            }
        }, { once: true });
    </script>
</body>
</html>
